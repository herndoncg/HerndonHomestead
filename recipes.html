<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Herndon Homestead · Recipes</title>
  <meta name="description" content="Herndon Homestead Recipes — Natural food, simple living, shared at the table.">
  <link rel="icon" href="favicon.ico">
  <style>
    /* =========================
       Brand Tokens
       ========================= */
    :root{
      --ocean: #005F86;
      --tan: #d2b48c;
      --charcoal: #333333;
      --accent: #ffd28f;
      --bg: #FAFAF8;
      --white: #ffffff;
      --radius: 14px;
      --shadow: 0 10px 20px rgba(0,0,0,.08), 0 2px 6px rgba(0,0,0,.06);
    }

    /* Base / Typography */
    html{scroll-behavior:smooth}
    body{
      margin:0;
      background: var(--bg);
      color: var(--charcoal);
      font-family: Inter, -apple-system, BlinkMacSystemFont, "Segoe UI", Arial, Helvetica, sans-serif;
      line-height:1.5;
    }
    h1,h2,h3,h4{font-family: Sitka, Georgia, "Times New Roman", Times, serif; color: var(--ocean); margin:0 0 .4rem}
    .tagline{font-style: italic; color:#555}
    a{color:var(--ocean); text-decoration:none}
    a:hover{color:#004861}
    .btn{
      display:inline-flex; align-items:center; gap:.5rem;
      background: var(--ocean); color: var(--white);
      border:none; border-radius: var(--radius);
      padding:.7rem 1rem; cursor:pointer; box-shadow: var(--shadow);
      transition: transform .2s ease, box-shadow .2s ease, background .2s ease;
    }
    .btn:hover{transform: translateY(-1px); background:#004e6d}
    .btn.secondary{background: var(--tan); color:#1b1b1b}
    .btn.secondary:hover{background:#c5a97d}
    .btn[disabled]{opacity:.6; cursor:not-allowed}
    .chip{display:inline-block; padding:.35rem .6rem; border-radius:999px; background:#eef5f8; color:#0f4256; font-size:.85rem}

    /* Small icon button (for modal close) */
    .icon-btn{display:inline-grid; place-items:center; width:36px; height:36px; border-radius:999px; border:none; cursor:pointer; background:rgba(255,255,255,.2); color:#fff; box-shadow: var(--shadow)}
    .icon-btn:hover{background:rgba(255,255,255,.35)}

    /* Layout */
    .container{width:min(1200px, 92%); margin-inline:auto}

    /* Sticky Header / Global Nav */
    header.site{
      position: sticky; top:0; z-index:1000; backdrop-filter: blur(10px);
      background: color-mix(in srgb, var(--white) 85%, transparent);
      border-bottom: 1px solid rgba(0,0,0,.06);
    }
    .nav{display:flex; align-items:center; justify-content:space-between; gap:1rem; padding:.75rem 0}
    .brand{display:flex; align-items:center; gap:.8rem}
    .brand .logo{width:38px; height:38px; border-radius:10px; background:linear-gradient(135deg, var(--ocean), #0a789f); box-shadow:var(--shadow)}
    .brand .name{font-family: Sitka, Georgia, serif; font-size:1.15rem; color:var(--ocean)}
    nav ul{list-style:none; display:flex; flex-wrap:wrap; gap:.8rem; padding:0; margin:0}
    nav a{padding:.45rem .7rem; border-radius:999px}
    nav a:hover{background: var(--accent); color:#4a3a13}

    /* Hero */
    .hero{position:relative; isolation:isolate; margin:1.25rem 0 0}
    .hero-inner{background: linear-gradient(180deg, #ffffff, #f5f2ec); border-radius: calc(var(--radius) * 1.5);
      padding: clamp(1.2rem, 2.5vw, 2rem); display:grid; grid-template-columns:1.2fr .8fr; gap:1.25rem; align-items:center;
      box-shadow: var(--shadow);
    }
    .hero h1{font-size: clamp(2rem, 4.2vw, 3rem)}
    .hero p{max-width:60ch}
    .hero .photo{min-height:220px; border-radius:var(--radius); background-position:center; background-size:cover; box-shadow: var(--shadow)}
    .hero .photo{background-image:url('https://images.unsplash.com/photo-1488477181946-6428a0291777?q=80&w=1600&auto=format&fit=crop')}

    /* Filter Bar */
    .filters{margin: 1rem 0 1.25rem; background: #fff; padding:.8rem; border-radius:var(--radius); box-shadow: var(--shadow); position:sticky; top:72px; z-index:900}
    .filters form{display:grid; grid-template-columns: repeat(6, 1fr); gap:.6rem}
    .filters select, .filters button{width:100%; padding:.6rem .75rem; border:1px solid #e5e5e5; border-radius: 10px; background:#fff; font:inherit}
    .filters button{border:none}

    /* Featured Carousel */
    .carousel{position:relative; overflow:hidden; border-radius:var(--radius); box-shadow: var(--shadow); background:#fff}
    .slides{display:flex; transition: transform .5s ease}
    .slide{flex:0 0 100%; display:grid; grid-template-columns: 1.2fr .8fr; min-height: 340px}
    .slide .img{background-size:cover; background-position:center}
    .slide .info{padding:1.1rem}
    .slide h3{margin-top:.4rem}
    .carousel .controls{position:absolute; inset:0; display:flex; justify-content:space-between; align-items:center; pointer-events:none}
    .carousel .controls button{pointer-events:auto; background: rgba(0,0,0,.55); color:#fff; border:none; width:42px; height:42px; border-radius:50%; display:grid; place-items:center}
    .carousel .controls button:hover{background: rgba(0,0,0,.75)}
    .carousel .dots{position:absolute; bottom:.6rem; left:50%; transform: translateX(-50%); display:flex; gap:.35rem}
    .carousel .dot{width:9px; height:9px; border-radius:50%; background:#d5d5d5; border:1px solid rgba(0,0,0,.2)}
    .carousel .dot.active{background: var(--ocean); border-color:var(--ocean)}

    /* Recipe Grid */
    .grid{display:grid; grid-template-columns: repeat(12, 1fr); gap:1rem; margin:1.2rem 0 2.2rem}
    .card{grid-column: span 6; background:#fff; border-radius:var(--radius); overflow:hidden; box-shadow: var(--shadow); display:flex; flex-direction:column}
    .card .cover{aspect-ratio: 4/3; background-size:cover; background-position:center}
    .card .body{padding:1rem}
    .card h3{margin:.2rem 0 .5rem}
    .meta{display:flex; flex-wrap:wrap; gap:.4rem; margin-bottom:.6rem}
    .card .actions{display:flex; gap:.5rem; margin-top:auto; padding:0 1rem 1rem}
    .card:hover{transform: translateY(-2px); transition: transform .2s ease}

    /* Footer */
    footer{background:#0b2e3d; color:#e9f2f6; padding:2.2rem 0; margin-top:2rem}
    footer .cols{display:grid; grid-template-columns:1.2fr .8fr; gap:1.2rem; align-items:center}
    footer a{color:#e9f2f6}
    .footer-bottom{margin-top:1rem; padding-top:1rem; border-top:1px solid rgba(255,255,255,.15); font-size:.95rem}

    /* Responsive */
    @media (max-width: 980px){
      .hero-inner{grid-template-columns:1fr}
      .slide{grid-template-columns:1fr}
      .filters form{grid-template-columns: repeat(2, 1fr)}
      .card{grid-column: span 12}
      footer .cols{grid-template-columns:1fr}
    }

    /* Print-Friendly CSS */
    @media print{
      header.site, .filters, .carousel, .actions, .chip, .controls, .dots{display:none !important}
      body{background:#fff}
      .card{box-shadow:none; border:1px solid #ddd}
      a{color:#000}
      .hero-inner{box-shadow:none; background:#fff}
      footer{color:#000; background:#fff; border-top:1px solid #ccc}
    }

    /* =========================
       Modal visibility control + toolbar + step list
       ========================= */
    #cookMode{position:fixed; inset:0; background:rgba(0,0,0,.5); display:none; place-items:center; z-index:2000}
    #cookMode:not([hidden]){display:grid}
    #cookShell{width:min(860px, 92%); background:#fff; border-radius:18px; box-shadow: var(--shadow); overflow:hidden}
    #cookHead{background:linear-gradient(180deg, var(--ocean), #0a6f93); color:#fff; padding:1rem 1.2rem; position:relative}
    #cookToolbar{display:flex; gap:.75rem; align-items:center; padding:.6rem 1.2rem; background:#fff; border-bottom:1px solid #eee}
    #cookToolbar .range{flex:1}
    #cookBody{padding:1rem 1.2rem; height:min(72vh, 78dvh); max-height:78dvh; overflow:auto}

    .step-list{list-style:none; padding:0; margin:.4rem 0 0}
    .step{display:flex; gap:.8rem; padding:.6rem .6rem .6rem .2rem; border-left:4px solid transparent; border-radius:12px; align-items:flex-start}
    .step-num{min-width:32px; height:32px; border-radius:999px; display:inline-grid; place-items:center; background:#e9eef1; color:#123; font-weight:700}
    .step.is-active{background: #eef6fa; border-color: var(--ocean)}
    .step.is-active .step-num{background: var(--ocean); color:#fff}

    /* a11y helpers */
    .sr-only{position:absolute!important; height:1px; width:1px; overflow:hidden; clip:rect(1px,1px,1px,1px); white-space:nowrap}
  </style>
</head>
<body>
  <!-- Header / Global Nav -->
  <header class="site">
    <div class="container nav">
      <div class="brand">
        <div class="logo" aria-hidden="true"></div>
        <div>
          <div class="name">Herndon Homestead</div>
          <div class="tagline">“Natural food, simple living, shared at the table.”</div>
        </div>
      </div>
      <nav aria-label="Primary">
        <ul>
          <li><a href="index.html">Home</a></li>
          <li><a href="about.html">About</a></li>
          <li><a href="subbrands.html">Sub-Brands</a></li>
          <li><a aria-current="page" href="recipes.html">Recipes</a></li>
          <li><a href="blog.html">Blog</a></li>
          <li><a href="shop.html">Shop</a></li>
          <li><a href="contact.html">Contact</a></li>
          <li><a href="support.html">Support</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <!-- Hero -->
  <section class="hero container" aria-labelledby="recipes-title">
    <div class="hero-inner">
      <div>
        <h1 id="recipes-title">Recipes</h1>
        <p>From sourdough and preserves to cast iron classics and seasonal pies—explore our family’s favorites. Filter by category, season, and more, then launch <strong>Cook Mode</strong> to follow the steps hands‑free.</p>
        <div class="meta" aria-label="Sub-brands">
          <span class="chip" title="Herndough">Herndough</span>
          <span class="chip" title="Herndon Harvest">Herndon Harvest</span>
          <span class="chip" title="The Herndon Table">The Herndon Table</span>
        </div>
      </div>
      <div class="photo" role="img" aria-label="Assorted homestyle dishes on a wooden table"></div>
    </div>
  </section>

  <!-- Filter Bar -->
  <section class="filters container" aria-label="Recipe filters">
    <form id="filterForm">
      <select name="category" aria-label="Category">
        <option value="">Category (All)</option>
        <option>Bread</option>
        <option>Dessert</option>
        <option>Main</option>
        <option>Preserving</option>
      </select>
      <select name="cuisine" aria-label="Cuisine">
        <option value="">Cuisine (All)</option>
        <option>American</option>
        <option>Southern</option>
        <option>Homestyle</option>
      </select>
      <select name="difficulty" aria-label="Difficulty">
        <option value="">Difficulty (All)</option>
        <option>Easy</option>
        <option>Moderate</option>
        <option>Challenging</option>
      </select>
      <select name="diet" aria-label="Diet">
        <option value="">Diet (All)</option>
        <option>Omni</option>
        <option>Vegetarian</option>
      </select>
      <select name="subbrand" aria-label="Sub-brand">
        <option value="">Sub-brand (All)</option>
        <option>Herndough</option>
        <option>Herndon Harvest</option>
        <option>The Herndon Table</option>
      </select>
      <select name="season" aria-label="Season">
        <option value="">Season (All)</option>
        <option>Spring</option>
        <option>Summer</option>
        <option>Fall</option>
        <option>Winter</option>
      </select>
    </form>
  </section>

  <!-- Featured Carousel -->
  <section class="container" aria-label="Featured recipes">
    <div class="carousel" id="featuredCarousel">
      <div class="slides">
        <article class="slide" data-target="#sourdough">
          <div class="img" style="background-image:url('https://images.unsplash.com/photo-1549931319-a545dcf3bc73?q=80&w=1600&auto=format&fit=crop')" role="img" aria-label="Country sourdough bread"></div>
          <div class="info">
            <p class="chip">Herndough · Bread</p>
            <h3>Country Sourdough Bread</h3>
            <p>Flour, water, starter, salt. A crusty loaf with a tender, open crumb—our daily table bread.</p>
            <div class="actions">
              <a class="btn" href="#sourdough">View Recipe</a>
              <button class="btn secondary cook-btn" data-slug="sourdough">Cook Mode</button>
            </div>
          </div>
        </article>
        <article class="slide" data-target="#cinnamonrolls">
          <div class="img" style="background-image:url('https://images.unsplash.com/photo-1616541826115-4610a3b3d7c2?q=80&w=1600&auto=format&fit=crop')" role="img" aria-label="Cinnamon rolls"></div>
          <div class="info">
            <p class="chip">Herndough · Dessert</p>
            <h3>Cinnamon Rolls</h3>
            <p>Soft spirals, buttery cinnamon sugar, and a simple glaze. Saturday morning perfection.</p>
            <div class="actions">
              <a class="btn" href="#cinnamonrolls">View Recipe</a>
              <button class="btn secondary cook-btn" data-slug="cinnamonrolls">Cook Mode</button>
            </div>
          </div>
        </article>
        <article class="slide" data-target="#steak">
          <div class="img" style="background-image:url('https://images.unsplash.com/photo-1544025162-d76694265947?q=80&w=1600&auto=format&fit=crop')" role="img" aria-label="Cast iron steak"></div>
          <div class="info">
            <p class="chip">The Herndon Table · Main</p>
            <h3>Cast Iron Skillet Steak</h3>
            <p>Butter‑basted with garlic and rosemary for a perfectly seared, tender steak at home.</p>
            <div class="actions">
              <a class="btn" href="#steak">View Recipe</a>
              <button class="btn secondary cook-btn" data-slug="steak">Cook Mode</button>
            </div>
          </div>
        </article>
        <article class="slide" data-target="#applepie">
          <div class="img" style="background-image:url('https://images.unsplash.com/photo-1505250469679-203ad9ced0cb?q=80&w=1600&auto=format&fit=crop')" role="img" aria-label="Holiday apple pie"></div>
          <div class="info">
            <p class="chip">The Herndon Table · Dessert</p>
            <h3>Holiday Apple Pie</h3>
            <p>Buttery crust, cinnamon apples, and a touch of lemon—classic comfort for any gathering.</p>
            <div class="actions">
              <a class="btn" href="#applepie">View Recipe</a>
              <button class="btn secondary cook-btn" data-slug="applepie">Cook Mode</button>
            </div>
          </div>
        </article>
      </div>
      <div class="controls" aria-hidden="false">
        <button type="button" class="prev" aria-label="Previous slide">❮</button>
        <button type="button" class="next" aria-label="Next slide">❯</button>
      </div>
      <div class="dots" role="tablist" aria-label="Featured slides">
        <button class="dot" aria-label="Slide 1"></button>
        <button class="dot" aria-label="Slide 2"></button>
        <button class="dot" aria-label="Slide 3"></button>
        <button class="dot" aria-label="Slide 4"></button>
      </div>
    </div>
  </section>

  <!-- Recipe Grid / List -->
  <main class="container" id="recipes" aria-label="All recipes">
    <div class="grid" id="recipeGrid">
      <article id="sourdough" class="card recipe" data-category="Bread" data-cuisine="Homestyle" data-difficulty="Moderate" data-diet="Vegetarian" data-subbrand="Herndough" data-season="All">
        <div class="cover" style="background-image:url('https://images.unsplash.com/photo-1519681393784-d120267933ba?q=80&w=1200&auto=format&fit=crop')"></div>
        <div class="body">
          <h3>Country Sourdough Bread</h3>
          <p class="meta"><span class="chip">#sourdough</span><span class="chip">Flour</span><span class="chip">Water</span><span class="chip">Starter</span><span class="chip">Salt</span></p>
          <p>A simple, rustic loaf: crunchy crust, tender crumb. Ingredients: flour, water, starter, salt.</p>
        </div>
        <div class="actions"><button class="btn cook-btn" data-slug="sourdough">Cook Mode</button><a class="btn secondary" href="#top" onclick="window.print(); return false;">Print</a></div>
      </article>

      <article id="cinnamonrolls" class="card recipe" data-category="Dessert" data-cuisine="American" data-difficulty="Moderate" data-diet="Vegetarian" data-subbrand="Herndough" data-season="All">
        <div class="cover" style="background-image:url('https://images.unsplash.com/photo-1594388853893-c5b0d6bb961e?q=80&w=1200&auto=format&fit=crop')"></div>
        <div class="body">
          <h3>Cinnamon Rolls</h3>
          <p class="meta"><span class="chip">#cinnamonrolls</span><span class="chip">Flour</span><span class="chip">Sugar</span><span class="chip">Butter</span><span class="chip">Cinnamon</span></p>
          <p>Soft, gooey rolls with buttery cinnamon swirls. Ingredients: flour, sugar, butter, cinnamon.</p>
        </div>
        <div class="actions"><button class="btn cook-btn" data-slug="cinnamonrolls">Cook Mode</button><a class="btn secondary" href="#top" onclick="window.print(); return false;">Print</a></div>
      </article>

      <article id="peaches" class="card recipe" data-category="Preserving" data-cuisine="Southern" data-difficulty="Easy" data-diet="Vegetarian" data-subbrand="Herndon Harvest" data-season="Summer">
        <div class="cover" style="background-image:url('https://images.unsplash.com/photo-1453838956707-38a7aa3cd62d?q=80&w=1200&auto=format&fit=crop')"></div>
        <div class="body">
          <h3>Canned Peaches</h3>
          <p class="meta"><span class="chip">#peaches</span><span class="chip">Peaches</span><span class="chip">Sugar</span><span class="chip">Jars</span><span class="chip">Water Bath</span></p>
          <p>Bright, summery peaches put up for winter. Ingredients: peaches, sugar, jars, water bath.</p>
        </div>
        <div class="actions"><button class="btn cook-btn" data-slug="peaches">Cook Mode</button><a class="btn secondary" href="#top" onclick="window.print(); return false;">Print</a></div>
      </article>

      <article id="steak" class="card recipe" data-category="Main" data-cuisine="American" data-difficulty="Easy" data-diet="Omni" data-subbrand="The Herndon Table" data-season="All">
        <div class="cover" style="background-image:url('https://images.unsplash.com/photo-1526318472351-c75fcf070305?q=80&w=1200&auto=format&fit=crop')"></div>
        <div class="body">
          <h3>Cast Iron Skillet Steak</h3>
          <p class="meta"><span class="chip">#steak</span><span class="chip">Steak</span><span class="chip">Butter</span><span class="chip">Garlic</span><span class="chip">Rosemary</span></p>
          <p>High‑heat sear, butter baste, rest and slice. Ingredients: steak, butter, garlic, rosemary.</p>
        </div>
        <div class="actions"><button class="btn cook-btn" data-slug="steak">Cook Mode</button><a class="btn secondary" href="#top" onclick="window.print(); return false;">Print</a></div>
      </article>

      <article id="applepie" class="card recipe" data-category="Dessert" data-cuisine="American" data-difficulty="Moderate" data-diet="Vegetarian" data-subbrand="The Herndon Table" data-season="Fall">
        <div class="cover" style="background-image:url('https://images.unsplash.com/photo-1519681392401-cb196449a1f1?q=80&w=1200&auto=format&fit=crop')"></div>
        <div class="body">
          <h3>Holiday Apple Pie</h3>
          <p class="meta"><span class="chip">#applepie</span><span class="chip">Apples</span><span class="chip">Sugar</span><span class="chip">Cinnamon</span><span class="chip">Pie Crust</span></p>
          <p>Classic cinnamon‑apple filling in a flaky crust. Ingredients: apples, sugar, cinnamon, pie crust.</p>
        </div>
        <div class="actions"><button class="btn cook-btn" data-slug="applepie">Cook Mode</button><a class="btn secondary" href="#top" onclick="window.print(); return false;">Print</a></div>
      </article>
    </div>
  </main>

  <!-- Cook Mode Modal (all steps visible + sticky slider) -->
  <div id="cookMode" role="dialog" aria-modal="true" aria-labelledby="cookTitle" hidden>
    <div id="cookShell">
      <div id="cookHead">
        <h2 id="cookTitle" style="margin:0; font-family: Sitka, Georgia, serif">Cook Mode</h2>
        <p style="margin:.25rem 0 0; opacity:.9">All steps visible — use slider / buttons or arrow keys</p>
        <button class="icon-btn" id="xClose" aria-label="Close Cook Mode" title="Close (Esc)" style="position:absolute; top:10px; right:10px">✕</button>
      </div>
      <div id="cookToolbar">
        <label class="sr-only" for="stepSlider">Step slider</label>
        <input id="stepSlider" class="range" type="range" min="1" max="1" value="1" />
        <span id="stepCounter">Step 1 of 1</span>
        <div style="margin-left:auto; display:flex; gap:.5rem">
          <button class="btn secondary" id="prevStep">Previous</button>
          <button class="btn secondary" id="closeCook">Close</button>
          <button class="btn" id="nextStep">Next</button>
        </div>
      </div>
      <div id="cookBody"></div>
    </div>
  </div>

  <!-- Footer -->
  <footer>
    <div class="container">
      <div class="cols">
        <div>
          <h3 style="color:#fff">Herndon Homestead</h3>
          <p class="tagline" style="color:#e9f2f6">“Natural food, simple living, shared at the table.”</p>
          <p style="max-width:60ch">We’re building a warm, home‑style kitchen—bread from <strong>Herndough</strong>, in‑season foods from <strong>Herndon Harvest</strong>, and hearty meals at <strong>The Herndon Table</strong>.</p>
        </div>
        <div>
          <h4 style="color:#fff; margin:0 0 .4rem">Proverbs 16:3</h4>
          <p>Commit your work to the Lord, and your plans will be established.</p>
        </div>
      </div>
      <div class="footer-bottom">
        <span>© <span id="year"></span> Herndon Homestead</span> ·
        <a href="privacy.html">Privacy</a> ·
        <a href="terms.html">Terms</a>
      </div>
    </div>
  </footer>

  <script>
    // Utilities
    const $ = (sel, ctx=document) => ctx.querySelector(sel);
    const $$ = (sel, ctx=document) => Array.from(ctx.querySelectorAll(sel));

    // Year
    $('#year').textContent = new Date().getFullYear();

    // Filters
    const form = $('#filterForm');
    const cards = $$('.recipe');
    form.addEventListener('change', () => {
      const vals = Object.fromEntries(new FormData(form).entries());
      cards.forEach(card => {
        const match = Object.entries(vals).every(([k,v]) => !v || card.dataset[k] === v);
        card.style.display = match ? '' : 'none';
      });
    });

    // Carousel
    const carousel = $('#featuredCarousel');
    const slides = $('.slides', carousel);
    const dots = $$('.dot', carousel);
    const totalSlides = $$('.slide', carousel).length;
    let cIndex = 0;
    function go(i){ cIndex = (i + totalSlides) % totalSlides; slides.style.transform = `translateX(-${cIndex*100}%)`; dots.forEach((d,di)=>d.classList.toggle('active', di===cIndex)); }
    $('.prev', carousel).addEventListener('click', ()=> go(cIndex-1));
    $('.next', carousel).addEventListener('click', ()=> go(cIndex+1));
    dots.forEach((d,di)=> d.addEventListener('click', ()=> go(di)) );
    go(0);
    setInterval(()=> go(cIndex+1), 7000);

    // Cook Mode data
    const recipesData = {
      sourdough: { yield: '1 large loaf', time: { total: '~5–9 hrs' }, ingredients: ['500 g bread flour','350 g water (room temp)','100 g active 100% hydration sourdough starter','10 g fine sea salt','Rice flour for dusting (optional)'], steps: ['In a bowl, mix flour and water until no dry spots remain. Rest 20 minutes (autolyse).','Add starter and salt; squeeze and fold to combine until cohesive.','Bulk ferment: Over 2 hours, perform 3–4 sets of stretch-and-folds every 30–40 minutes.','Let rise until ~50–75% larger, jiggly, and aerated (1–3 more hours depending on temp).','Lightly flour the counter, pre‑shape into a round; rest 15 minutes.','Final shape into a tight boule; place seam‑up in a floured banneton. Proof 1–2 hours at room temp or 8–12 hours cold.','Preheat Dutch oven at 475°F/245°C for 30–45 minutes. Score loaf.','Bake 20 minutes covered, then 20–25 minutes uncovered until deep golden and ~208–212°F internal.','Cool fully on a rack (at least 1 hour) before slicing.'] },
      cinnamonrolls: { yield: '12 rolls', time: { total: '~2.5–3 hrs' }, ingredients: ['240 ml warm milk','7 g instant yeast','50 g granulated sugar','2 large eggs','75 g unsalted butter, melted','450 g all‑purpose flour','1 tsp fine salt','Filling: 110 g softened butter, 200 g brown sugar, 2 Tbsp ground cinnamon','Glaze: 120 g powdered sugar + 2–3 Tbsp milk + 1 tsp vanilla (optional)'], steps: ['Whisk milk, yeast, and sugar; rest 5 minutes until foamy.','Mix in eggs and melted butter; add flour and salt. Knead until smooth and elastic (5–8 min).','Cover and rise until doubled (60–90 min).','Roll to 12×18 in (30×45 cm). Spread butter, sprinkle brown sugar + cinnamon.','Roll up from long side; cut 12 pieces. Place in greased 9×13 in pan; rise until puffy (30–45 min).','Bake at 350°F/175°C for 20–25 minutes until lightly golden.','Whisk glaze and drizzle over warm rolls. Rest 10 minutes before serving.'] },
      peaches: { yield: '6–7 pints', time: { total: '~1.5–2 hrs' }, ingredients: ['4–5 lb ripe but firm peaches','Light syrup: 6 cups water + 1½ cups sugar (or use water/juice)','2 Tbsp lemon juice (optional, color)','7 pint jars with lids/rings, water‑bath canner, jar lifter'], steps: ['Prep canner; heat clean jars in hot water. Simmer lids (do not boil).','Blanch peaches 30–60 sec; chill in ice bath. Peel, pit, and slice.','Simmer light syrup. Toss peaches with lemon juice (optional).','Pack fruit into hot jars. Ladle hot syrup to ½\" headspace. De‑bubble, wipe rims, apply lids/rings fingertip‑tight.','Process in boiling water: pints 25 min, quarts 30 min (adjust for altitude).','Cool 12–24 hrs. Check seals, remove rings, label, and store in a cool dark place.'] },
      steak: { yield: '2 servings', time: { total: '25–30 min' }, ingredients: ['2 ribeye or strip steaks, ~1¼ in thick','Kosher salt & freshly cracked black pepper','1–2 Tbsp high‑heat oil','3 Tbsp butter','3 garlic cloves, smashed','2 sprigs fresh rosemary or thyme'], steps: ['Pat steaks very dry; season heavily with salt and pepper.','Heat cast‑iron over high until smoking. Add oil; lay steaks away from you.','Sear 2–3 min per side for crust. Reduce heat to medium; add butter, garlic, herbs.','Tilt pan and baste continuously 1–2 min. Target temps: 125°F rare, 130–135°F med‑rare, 140°F medium.','Rest 5–10 minutes on a rack. Slice against the grain and serve.'] },
      applepie: { yield: '1 (9‑inch) pie', time: { total: '~3+ hrs' }, ingredients: ['2 pie crusts (homemade or store‑bought)','6–7 medium apples (mix of tart/sweet), peeled & sliced','150 g granulated sugar','2 tsp ground cinnamon + pinch nutmeg','¼ tsp salt','2 Tbsp flour or cornstarch','1 Tbsp lemon juice','Egg wash: 1 egg + 1 Tbsp water; coarse sugar for top'], steps: ['Toss apples with sugar, cinnamon, nutmeg, salt, flour/cornstarch, and lemon juice. Set aside 10 min.','Line 9‑in pie dish with bottom crust. Fill with apples; dot with small butter pieces (optional).','Top with second crust or lattice; trim and crimp. Brush with egg wash; sprinkle coarse sugar.','Bake 20 min at 425°F/220°C. Reduce to 375°F/190°C and bake 35–45 min more until deep golden and bubbling.','Cool at least 2 hours before slicing so juices set.'] }
    };

    // Modal controls
    const cookModal = $('#cookMode');
    const cookBody = $('#cookBody');
    const cookTitle = $('#cookTitle');
    const btnPrev = $('#prevStep');
    const btnNext = $('#nextStep');
    const stepSlider = $('#stepSlider');
    const stepCounter = $('#stepCounter');
    let activeSlug = null; let stepIndex = 0;

    function renderSteps(){
      const r = recipesData[activeSlug];
      if(!r){ cookBody.innerHTML = '<p>No steps found.</p>'; return; }
      const total = r.steps.length;
      const list = r.steps.map((t,i)=> `
        <li class="step ${i===stepIndex?'is-active':''}" data-idx="${i}">
          <span class="step-num">${i+1}</span>
          <div class="step-text">${t}</div>
        </li>`).join('');

      cookBody.innerHTML = `
        <div style="display:flex; flex-wrap:wrap; gap:1rem; margin:.2rem 0 1rem; font-size:.95rem">
          <span class="chip">Yield: ${r.yield || '—'}</span>
          ${r.time ? `<span class="chip">Total: ${r.time.total || ''}</span>` : ''}
        </div>
        <details open>
          <summary style="cursor:pointer; font-weight:600; color:#0f4256">Ingredients</summary>
          <ul style="margin:.2rem 0 1rem 1.2rem">${(r.ingredients||[]).map(it=>`<li>${it}</li>`).join('')}</ul>
        </details>
        <ol id="stepList" class="step-list" aria-label="Recipe steps">${list}</ol>
      `;

      // Ensure current step stays in view without hiding toolbar
      const current = $('#stepList .is-active', cookBody);
      if(current){ current.scrollIntoView({block:'nearest'}); }

      updateToolbar(total);
    }

    function updateToolbar(total){
      stepSlider.max = String(total);
      stepSlider.value = String(stepIndex + 1);
      stepCounter.textContent = `Step ${stepIndex+1} of ${total}`;
      btnPrev.disabled = stepIndex <= 0;
      btnNext.disabled = stepIndex >= total-1;
    }

    function openCook(slug, title){
      activeSlug = slug; stepIndex = 0; cookTitle.textContent = `Cook Mode · ${title}`; cookModal.hidden = false; document.body.style.overflow = 'hidden'; renderSteps();
    }
    function closeCook(){ cookModal.hidden = true; document.body.style.overflow = ''; }

    // Open from buttons
    $$('.cook-btn').forEach(btn=> btn.addEventListener('click', (e)=>{
      const slug = e.currentTarget.dataset.slug;
      const title = e.currentTarget.closest('.card, .slide').querySelector('h3').textContent.trim();
      openCook(slug, title);
    }));

    // Close controls
    $('#closeCook').addEventListener('click', closeCook);
    $('#xClose').addEventListener('click', closeCook);
    cookModal.addEventListener('click', (e)=>{ if(e.target === cookModal) closeCook(); });

    // Keyboard nav in Cook Mode
    document.addEventListener('keydown', (e)=>{
      if(cookModal.hidden) return;
      if(e.key === 'Escape' || e.key === 'Esc'){ closeCook(); }
      if(e.key === 'ArrowRight'){ btnNext.click(); }
      if(e.key === 'ArrowLeft'){ btnPrev.click(); }
      if(e.key === ' '){ e.preventDefault(); btnNext.click(); }
    });

    // Step nav button handlers
    btnNext.addEventListener('click', ()=>{ const arr = recipesData[activeSlug]?.steps || []; if(stepIndex < arr.length-1){ stepIndex++; renderSteps(); }});
    btnPrev.addEventListener('click', ()=>{ if(stepIndex > 0){ stepIndex--; renderSteps(); } });

    // Slider control
    stepSlider.addEventListener('input', ()=>{ const val = parseInt(stepSlider.value, 10) || 1; stepIndex = Math.max(0, val-1); renderSteps(); });

    // Click a step to jump
    cookBody.addEventListener('click', (e)=>{
      const li = e.target.closest('li.step');
      if(!li) return;
      stepIndex = parseInt(li.dataset.idx, 10) || 0;
      renderSteps();
    });

    // Lightweight tests
    function test(name, fn){ try{ fn(); console.info('✅ '+name); } catch(e){ console.error('❌ '+name, e); } }
    document.addEventListener('DOMContentLoaded', ()=>{
      test('modal hidden by default', ()=> { if(!$('#cookMode').hidden) throw new Error('Modal should start hidden'); });
      test('carousel initializes', ()=> { if(!dots.length) throw new Error('Dots not found'); go(0); if(!dots[0].classList.contains('active')) throw new Error('First dot not active'); });
      test('renderSteps includes Ingredients', ()=> { activeSlug='sourdough'; stepIndex=0; renderSteps(); if(!$('#cookBody').innerHTML.includes('Ingredients')) throw new Error('Ingredients not rendered'); });
      test('slider syncs with next()', ()=> { const before = $('#stepSlider').value; stepIndex=0; renderSteps(); $('#nextStep').click(); const after = $('#stepSlider').value; if(Number(after) !== Number(before)+1) throw new Error('Slider did not advance'); });
    });
  </script>
</body>
</html>
